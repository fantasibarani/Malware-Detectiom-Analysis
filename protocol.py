from scapy.all import *
packets = rdpcap("dump.pcap")
# Set Awal Nilai Protocol untuk Graph Size
arp=0
gr_arp=0
udp=0
grudp=0
tcp=0
grtcp=0
dns=0
grdns=0
icmp=0
gricmp=0
pop=0
grpop=0
imap=0
grimap=0
http=0
grhttp=0
https=0
grhttps=0
ssh=0
grssh=0
ftp=0
grftp=0
rotpro=0
graph_sizepro=0
# for packet in packets: 
# 	
for packet in packets: 
	if packet.haslayer(TCP):  
		grtcp=1
	   #Memberi Nilai 1 jika  protokol TCP Diakses dan seterusnya untuk protokol yang lainnya 
		tcp+=1
		# Memprint summary aktivitas jaringan
		# print(packet.summary())
	if packet.haslayer(UDP):
		udp+=1     
		grudp=1
 		# print(packet.summary())
 	if packet.haslayer(ARP):  
 		arp+=1   
 		gr_arp=1
	 	# print(packet.summary())

	if packet.haslayer(DNS):
 		dns+=1   
 		grdns=1
		# print(packet.summary())
	if packet.haslayer(ICMP):
 		icmp+=1   
 		gricmp=1
		# print(packet.summary())
	if packet.haslayer(pop):
 		pop+=1  
 		grpop=1 
		# print(packet.summary())
	if packet.haslayer(imap):
 		imap+=1   
 		grimap=1
		# print(packet.summary())
	if packet.haslayer(http):
 		http+=1   
 		grhttp=1
		# print(packet.summary())
	if packet.haslayer(https):
 		https+=1   
 		grhttps=1
		# print(packet.summary())
	if packet.haslayer(ssh):
 		ssh+=1   
 		grssh=1
		# print(packet.summary())
	if packet.haslayer(ftp):
 		ftp+=1  
 		grftp=1 
		# print(packet.summary())

rotpro=arp+tcp+udp+dns+icmp+pop+imap+http+https+ssh+ftp
graph_sizepro=grftp+grssh+grhttp+grhttps+grimap+grpop+gricmp+grdns+gr_arp+grtcp+grudp
# Menampilkan Protokol yang diakses
if arp!=0:
	print "Protokol ARP   : ", arp 
if tcp!=0:
	print "Protokol TCP   : ", tcp
if udp!=0:
	print "Protokol UDP   : ", udp
if dns!=0:
	print "Protokol DNS   : ", dns
if icmp!=0:
	print "Protokol ICMP  : ", icmp
if pop!=0:
	print "Protokol POP3  : ", pop
if imap!=0:
	print "Protokol IMAP  : ", imap
if http!=0:
	print "Protokol HTTP  : ", http
if https!=0:
	print "Protokol HTTPS : ", https
if ssh!=0:
	print "Protokol SSH   : ", ssh
if ssh!=0:
	print "Protokol FTP   : ", ftp
# print "Root out Degree:", rotpro
# print "Graph Size 	: ", graph_sizepro

